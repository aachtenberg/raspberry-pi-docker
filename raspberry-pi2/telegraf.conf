# Telegraf Configuration for Raspberry Pi 2
# Docker metrics collection only (no MQTT)

[global_tags]
  source = "raspberry-pi2"
  host = "raspberrypi2.local"

[agent]
  interval = "10s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "10s"
  flush_jitter = "0s"
  precision = ""
  debug = false
  quiet = false
  logfile = ""
  hostname = "raspberrypi2"
  omit_hostname = false

# ==============================================================================
# INPUT PLUGINS - Docker Container Metrics
# ==============================================================================

[[inputs.docker]]
  endpoint = "unix:///var/run/docker.sock"
  gather_services = false
  source_tag = false
  container_name_include = []
  container_name_exclude = []
  timeout = "5s"
  docker_label_include = ["com.docker.compose.service", "com.docker.compose.project"]
  tag_env = []

# Scrape node-exporter metrics (including backup status)
[[inputs.prometheus]]
  urls = ["http://node-exporter:9100/metrics"]
  metric_version = 2

# ==============================================================================
# OUTPUT PLUGINS
# ==============================================================================

# Expose Telegraf metrics on /metrics endpoint (includes node-exporter via Prometheus input)
[[outputs.prometheus_client]]
  listen = ":9273"
  path = "/metrics"
  collectors_exclude = ["gocollector", "process"]

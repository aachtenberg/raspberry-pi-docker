# Environment Variables for Docker Compose
# Copy this file to .env and replace all placeholder values with your actual credentials

# ==============================================================================
# Cloudflare Tunnel Configuration
# ==============================================================================
# Get this from: https://one.dash.cloudflare.com/ → Access → Tunnels
# Copy the tunnel token from your configured tunnel
CLOUDFLARE_TUNNEL_TOKEN=<redacted>

# ==============================================================================
# InfluxDB Configuration
# ==============================================================================
# Admin username for InfluxDB initial setup
INFLUXDB_ADMIN_USERNAME=admin

# Admin password for InfluxDB web UI login
# Use a strong password (12+ characters, mix of letters, numbers, symbols)
INFLUXDB_ADMIN_PASSWORD=YOUR_SECURE_PASSWORD_HERE

# Organization ID - Get from InfluxDB UI after first setup, or use existing
# To find: docker exec -it influxdb influx org list
# Copy the ID column value (16-character hex string)
INFLUXDB_ORG_ID=YOUR_16_CHAR_ORG_ID_HERE

# Bucket name for storing sensor data
INFLUXDB_BUCKET=sensor_data

# Admin API Token - Generate in InfluxDB UI
# InfluxDB UI → Data → API Tokens → Generate API Token → All Access Token
# This token is used by ESP devices and Grafana
INFLUXDB_ADMIN_TOKEN=EXAMPLE_TOKEN

# ==============================================================================
# InfluxDB 3 Core Configuration (Optional - for next-gen database)
# ==============================================================================
# InfluxDB 3 Core admin token - required for API access
# Generate with: docker compose exec influxdb3-core influxdb3 create token --admin
# IMPORTANT: Store securely, will not be shown again
INFLUXDB3_ADMIN_TOKEN=YOUR_INFLUXDB3_ADMIN_TOKEN_HERE

# InfluxDB 3 UI session key - required to persist UI configuration across restarts
# Generate with: openssl rand -hex 32
INFLUXDB3_UI_SESSION_KEY=YOUR_64_CHAR_HEX_STRING_HERE

# Grafana admin password
# Default username is 'admin', change password on first login
# GRAFANA_ADMIN_PASSWORD=YOUR_GRAFANA_PASSWORD_HERE

# ==============================================================================
# Notes
# ==============================================================================
# - NEVER commit the actual .env file to Git
# - Keep this .env.example file with placeholders only
# - See docs/SETUP.md for detailed setup instructions

# ==============================================================================
# Grafana Cloud Configuration
# ==============================================================================
# Grafana Cloud URL (your instance URL)
GRAFANA_CLOUD_URL=https://aachten.grafana.net

# Grafana Cloud Service Account Token - for dashboard automation
# Create at: https://aachten.grafana.net → Administration → Service Accounts
# Create service account with Editor role, then add a token
# Token format: glsa_...
GRAFANA_CLOUD_API_KEY=YOUR_SERVICE_ACCOUNT_TOKEN_HERE

# ==============================================================================
# Grafana Cloud PDC Agent Configuration
# ==============================================================================
# Grafana PDC Agent token - obtain from Grafana Cloud dashboard
GRAFANA_PDC_TOKEN=YOUR_GRAFANA_PDC_TOKEN_HERE

# Grafana Cloud cluster identifier (e.g., prod-ca-east-0)
GRAFANA_PDC_CLUSTER=prod-ca-east-0

# Grafana Cloud hosted Grafana instance ID
GRAFANA_PDC_GCLOUD_HOSTED_GRAFANA_ID=YOUR_GRAFANA_ID_HERE

# ==============================================================================
# AI Monitor (Optional)
# ==============================================================================
# AI monitor settings (safe by default: analyze only, no remediation)
AI_MONITOR_INTERVAL_SECONDS=60
AI_MONITOR_EXECUTE=false

# Optional: keep self-heal responsive even if Prometheus/LLM are slow
AI_MONITOR_LLM_ENABLED=true
AI_MONITOR_PROM_TIMEOUT_SECONDS=5

# LLM API Options (priority: Claude > Gemini)
# Claude API (recommended - fast, reliable, ~11s response time)
# Get key from: https://console.anthropic.com/settings/keys
# Cost: ~$0.25/1M tokens ($0.50/month for typical usage)
# CLAUDE_API_KEY=sk-ant-api03-...
# CLAUDE_MODEL=claude-3-haiku-20240307

# Gemini API (cheaper alternative - 70% less than Claude, ~3-5s response time)
# Get key from: https://aistudio.google.com/app/apikey
# Cost: ~$0.075/1M tokens ($0.15/month for typical usage)
# GEMINI_API_KEY=AIza...
# GEMINI_MODEL=gemini-2.0-flash-exp

# Self-heal guardrails
AI_MONITOR_SELF_HEAL_DOCKER_HEALTH=true
AI_MONITOR_RESTART_COOLDOWN_SECONDS=600
AI_MONITOR_MAX_RESTARTS_PER_RUN=2

# Comma-separated container names the agent is allowed to restart when execute=true
# SAFE DEFAULT: Only restart stateless/easily-recovered services
# WARNING: Do NOT include: mosquitto, influxdb3-core, nginx-proxy-manager, homeassistant
# (See docs/AI_MONITOR.md for protected services list)
AI_MONITOR_ALLOWED_CONTAINERS=telegraf,prometheus

# Pi2-specific allowlist (for ai-monitor running on raspberrypi2)
# WARNING: Do NOT include: postgres (camera-dashboard DB), timescaledb, mediamtx
AI_MONITOR_ALLOWED_CONTAINERS_PI2=telegraf,promtail

# HTTP synthetic checks (semicolon-separated: url|expected_status[|Header=value])
# Pi1 checks (nginx-proxy-manager, influxdb3, homeassistant, etc.)
AI_MONITOR_HTTP_CHECKS=http://nginx-proxy-manager:81|200;http://influxdb3-core:8181/metrics|200;http://homeassistant:8123|200

# Pi2 checks (camera dashboard API and web UI)
AI_MONITOR_HTTP_CHECKS_PI2=http://camera-dashboard-api-1:8080|200;http://camera-dashboard-web-1:80|200

# Predictive Monitoring (proactive issue detection)
# Checks Prometheus for concerning trends (memory growth, disk usage, etc.)
# Only calls LLM if thresholds exceeded
# Recommended: enabled with daily checks (~10-20 LLM calls/month, ~$0.25-0.50/month)
AI_MONITOR_PREDICTIVE_ENABLED=false
AI_MONITOR_PREDICTIVE_INTERVAL_SECONDS=86400  # 86400 = daily

# Incident Reports (automatic documentation)
# Saves markdown reports to ai-monitor/incidents/ directory
# No extra LLM calls - just formats existing triage data
AI_MONITOR_INCIDENT_REPORTS_ENABLED=true

# Optional overrides (usually not needed)
# AI_MONITOR_PROMETHEUS_URL=http://prometheus:9090
# AI_MONITOR_LOG_LEVEL=info

# ==============================================================================
# TimescaleDB Configuration (Pi 2)
# ==============================================================================
# Password for the 'postgres' superuser
POSTGRES_PASSWORD=YOUR_SECURE_POSTGRES_PASSWORD_HERE
